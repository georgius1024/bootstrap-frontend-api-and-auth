# Заготовка frontend-a с авторизацией, покрыто тестами

## Список событий
- busy // приложение занято - включить крутилку
- idle // приложение интерактивно - выключить крутилку
- login  // пользователь вошел, надо адаптировать интерфейс
- logout // пользователь вышел, ничего недоступно
- restore // пользователь восстановлен из прошлой сессии
- credentials // пришла авторизация (обновить токены)
- refuse // отменена авторизация (разлогинить пользователя)
- app-error // случилась ошибка (показать попап)
- app-message // пришло сообщение (показать тостер)

## список компонентов+тесты
- toolbar - меню, заголовок - проверить наличие div-ов и надписей
- viewPort - место для вывода контента - проверить наличие div-ов
- spinner - крутилка: вкл/выкл - проверить наличие div-ов во всех состояниях
- bottom - место для подножия. должны быть div-ы и нужные надписи
- scrollTop - прокрутка вверх. проверить наличие в странице элементов
- message - панелька с сообщением. Должна включаться и выключаться. Проверить наличием текстов и элементов во всех состояниях

##app - главный компонент приложения
  - подписывается на login && logout && restore - меняет раскладку, меню и т.п.
  - подписывается на busy и idle показывает и прячет лоадер
  - подписывается на error и message показывает сообщение

## Модули
###config - массив конфигураций для разных сред
 - название проекта
 - копирайт
 - версия
 - адрес API
 проверка - вызывать для разных сред, проверить наличие полей,
 адрес API должен отличаться для dev/prod
 --- не удается вызвать для разных сред

###events - event-bus - проверить:
 - создание - без ошибок
 - подписка - без ошибок
 - отправка событий после подписки: события приходят
 - отписка - без ошибок
 - отправка событий после отписки: события НЕ приходят

##session-storage && localstorage - проверить
 - все, что есть sessionStorage или в localStorage - доступно, создается, очищается

##store - vue-store
##модуль account - профиль пользователя
  - должен уметь login/logout/isLoggedIn.
  - хранит профайл, access- refresh- tokens
  - проверить, что login-logout-restore-credentials эмитируются по шине событий

##router - маршрутизатор. Подключен к store, знает о наличии пользователя
  - не некторые пути пускает без авторизавции
  - на прочие - только с авторизацией

##api - работа с API бэкенда
  - подписывается на события login && logout
  - в зависимости от credential/logout приспосабливает параметры запроса
  - сохраняет и access- и refresh- tokens
  - при обращении к чему-то эмитирует busy и idle
  - при возвращении ошибки эмитирует error
  - при сбое авторизации (ошибка 401) использует refreshtoken для обновления токена и повтора запроса
  - при получении message эмитирует message


